document.addEventListener("DOMContentLoaded",(function(){var t=document.getElementById("bnb-calculator");const n=document.createElement("meta");n.setAttribute("charset","UTF-8"),document.head.appendChild(n);const e=document.createElement("style");function a(t){return new Promise(((n,e)=>{const a=document.createElement("script");a.src=t,a.onload=()=>n(),a.onerror=()=>e(new Error(`Failed to load script: ${t}`)),document.head.appendChild(a)}))}e.type="text/css",e.innerText="\n        #modal-container {\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background: rgba(0, 0, 0, 0.5);\n            z-index: 100;\n        }\n        #calculator-modal {\n            background: #f3f4f6;\n            width: 80%;\n            height: 85%;\n            max-width: 90%;\n            border-radius: 8px;\n            padding: 20px;\n            font-family: Arial, sans-serif;\n            box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.2);\n            overflow-y: scroll;\n            scrollbar-width: none;\n        }\n        #calculator-modal h2 {\n            text-align: center;\n            color: #003b73;\n            margin-bottom: 20px;\n            font-size: 35px !important;\n        }\n        .section-title {\n            color: #003b73;\n            font-weight: bold;\n            margin-top: 20px;\n        }\n        .form-group {\n            display: flex;\n            gap: 10px;\n            margin-bottom: 15px;\n        }\n        .form-group label {\n            flex: 1;\n            align-content: center;\n        }\n        fieldset {\n            margin-top:15px;\n            color: #003b73;\n            font-weight: bold;\n            border-radius: 12px;\n        }\n        .form-group input,select {\n            flex: 1;\n            padding: 8px;\n            border: 1px solid #ccc;\n            border-radius: 4px;\n            font-size: 1em;\n            height:35px;\n        }\n        .bnb-button {\n            width: 100%;\n            background-color: #007bff;\n            color: white;\n            font-size: 1.2em;\n            border: none;\n            border-radius: 4px;\n            padding: 10px;\n            cursor: pointer;\n            margin-top: 20px;\n        }\n        .bnb-button:hover {\n            background-color: #0056b3;\n        }\n\n        .result-table {\n            width: 100%;\n            margin-top: 55px;\n            border-collapse: collapse;\n            background-color: #f0f0f0;\n        }\n        .result-table, .result-table th, .result-table td {\n            border: 1px solid #ccc;\n            padding: 8px;\n            text-align: center;\n        }\n        .result-table th {\n            background-color: #007bff;\n            font-weight: bold;\n            color: white;\n        }\n        .result-table td {\n            background-color: #f3f4f6;\n        }\n        .chart-container {\n            margin-top: 30px;\n        }\n\n        .info-icon {\n            display: inline-flex;\n            align-items: center;\n            justify-content: center;\n            width: 16px;\n            height: 16px;\n            border-radius: 50%;\n            background-color: #1673af;\n            color: white;\n            font-size: 12px;\n            font-style: italic;\n            cursor: help;\n        }    \n\n        .tooltip {\n            position: absolute;\n            background-color: #333;\n            color: #fff;\n            margin-left: 15px;\n            padding: 5px 10px;\n            border-radius: 5px;\n            z-index: 1000;\n            width: 250px;\n            height: auto;\n            transform: translateY(-100%); \n        }\n    ",document.head.appendChild(e),async function(){try{await a("https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"),await a("https://code.highcharts.com/highcharts.js"),await a("https://code.highcharts.com/highcharts-3d.js")}catch(t){console.error(t)}}(),t.innerHTML='\n        <div id="modal-container">\n            <div id="calculator-modal">\n                <div id="tooltip" class="tooltip"  style="display: none;"></div>\n                <h2>BnB Profit Calculator for Spain</h2>\n                <form id="bnb-calculator-form">\n\n                    <fieldset>\n                        <legend>Property Value and Financing:</legend>\n                        <div class="section-title"></div>\n                        <div class="form-group">\n                            <label>Mortgage Term Years <span class="info-icon" data-tooltip="0">i<span></label>\n                            <select id="termYears"> \n                                <option>10</option>\n                                <option>15</option>\n                                <option>20</option>\n                                <option>25</option>\n                                <option>30</option>\n                            </select>\n                        </div>\n                        <div class="form-group">\n                            <label>Property Purchase Price (&euro;) <span class="info-icon" data-tooltip="1">i<span></label>\n                            <input type="number" id="purchasePrice" placeholder="0">\n                        </div>\n                        <div class="form-group">\n                            <label>Annual Percentage Rate (%) <span class="info-icon" data-tooltip="2">i<span></label>\n                            <input type="number" id="interestRate" placeholder="0">\n                        </div>\n                        <div class="form-group">\n                            <label>Deposit (&euro;) <span class="info-icon" data-tooltip="3">i<span></label>\n                            <input type="number" id="propertyPrice" placeholder="0">\n                        </div>\n                        <div class="form-group">\n                            <label>Energy-Efficient Property? <span class="info-icon" data-tooltip="4">i<span></label>\n                            <input type="checkbox" id="propertyType" style = "height:30px;">\n                        </div>\n                        <div class="form-group">\n                            <label>Property Type <span class="info-icon" data-tooltip="5">i<span></label>\n                            <select id="propertyTypeCmb"> \n                                <option value = "11.5">New</option>\n                                <option value = "8">Resale</option>\n                            </select>\n                        </div>\n                    </fieldset>\n                    \n                    <fieldset>\n                        <legend>Startup Fees:</legend>\n                        <div class="section-title"></div>\n                        <div class="form-group">\n                            <label>Home Furnishing (&euro;) <span class="info-icon" data-tooltip="6">i<span></label>\n                            <input type="number" id="startupFeeFurnishing" placeholder="0">\n                        </div>\n                        <div class="form-group">\n                            <label>Renovations (&euro;) <span class="info-icon" data-tooltip="7">i<span></label>\n                            <input type="number" id="startupFeeRenovations" placeholder="0">\n                        </div>\n                    </fieldset>    \n\n                    <fieldset>\n                        <legend>Rental Income Criteria:</legend>\n                        <div class="section-title"></div>\n                        <div class="form-group">\n                            <label>Price per night per Guest (&euro;) <span class="info-icon" data-tooltip="8">i<span></label>\n                            <input type="number" id="rentalPrice" placeholder="0">\n                        </div>\n                        <div class="form-group">\n                            <label>Nr of Max. Guests <span class="info-icon" data-tooltip="9">i<span></label>\n                            <input type="number" id="rentalMax" placeholder="0">\n                        </div>\n                        <div class="form-group">\n                            <label>Occupancy Rate (%) <span class="info-icon" data-tooltip="10">i<span></label>\n                            <input type="number" id="rentalRate" placeholder="0">\n                        </div>\n                        <div class="form-group">\n                            <label>Operating Days Annually <span class="info-icon" data-tooltip="11">i<span></label>\n                            <input type="number" id="rentalAnnual" placeholder="0">\n                        </div>\n                    </fieldset>\n\n                    <fieldset>\n                        <legend>Operating Expenses:</legend>\n                        <div class="section-title"></div>\n                        <div class="form-group">\n                            <label>Management Fee (%) <span class="info-icon" data-tooltip="12">i<span></label>\n                            <input type="number" id="managementFee" placeholder="0">\n                        </div>\n                        <div class="form-group">\n                            <label>Property Tax (%) <span class="info-icon" data-tooltip="13">i<span></label>\n                            <input type="number" id="propertyTax" placeholder="0">\n                        </div>\n                        <div class="form-group">\n                            <label>Community Fees (&euro;) <span class="info-icon" data-tooltip="14">i<span></label>\n                            <input type="number" id="communityFee" placeholder="0">\n                        </div>\n                        <div class="form-group">\n                            <label>Maintenance and repairs (&euro;) <span class="info-icon" data-tooltip="15">i<span></label>\n                            <input type="number" id="maintenanceFee" placeholder="0">\n                        </div>\n                        <div class="form-group">\n                            <label>Insurance (&euro;) <span class="info-icon" data-tooltip="16">i<span></label>\n                            <input type="number" id="insuranceFee" placeholder="0">\n                        </div>\n                        <div class="form-group">\n                            <label>License Obtaining and Renweal Fees (&euro;) <span class="info-icon" data-tooltip="17">i<span></label>\n                            <input type="number" id="licenseFee" placeholder="0">\n                        </div>\n                        <div class="form-group">\n                            <label>Advertising Costs per Month (&euro;) <span class="info-icon" data-tooltip="18">i<span></label>\n                            <input type="number" id="advertisingFee" placeholder="0">\n                        </div>\n                        <div class="form-group">\n                            <label>Gas Bill Monthy (&euro;) <span class="info-icon" data-tooltip="19">i<span></label>\n                            <input type="number" id="gasFee" placeholder="0">\n                        </div>\n                        <div class="form-group">\n                            <label>Energy Bill Monthly (&euro;) <span class="info-icon" data-tooltip="20">i<span></label>\n                            <input type="number" id="energyFee" placeholder="0">\n                        </div>\n                        <div class="form-group">\n                            <label>WiFi Monthly (&euro;) <span class="info-icon" data-tooltip="21">i<span></label>\n                            <input type="number" id="wifiFee" placeholder="0">\n                        </div>\n                        <div class="form-group">\n                            <label>Water Bill Monthly (&euro;) <span class="info-icon" data-tooltip="22">i<span></label>\n                            <input type="number" id="waterFee" placeholder="0">\n                        </div>\n                    </fieldset>    \n\n                    <fieldset>\n                        <legend>BnB Renting Platforms:</legend>\n                        <div class="section-title"></div>\n                        <div class="form-group">\n                            <label>AirBnB (%) <span class="info-icon" data-tooltip="23">i<span></label>\n                            <input type="number" id="rentingAirBnB" placeholder="0">\n                            <input type="checkbox" id="isAirBnB">\n                        </div>\n                        <div class="form-group">\n                            <label>Booking.com (%) <span class="info-icon" data-tooltip="24">i<span></label>\n                            <input type="number" id="rentingBooking" placeholder="0">\n                            <input type="checkbox" id="isBooking">\n                        </div>\n                    </fieldset>  \n\n                     <fieldset>\n                        <legend>Living Situation:</legend>\n                        <div class="form-group">\n                            <label>Living Situation Select <span class="info-icon" data-tooltip="25">i<span></label>\n                            <select id="livingTypeCmb"> \n                                <option value = "1">EU Resident</option>\n                                <option value = "2">Spanish Resident</option>\n                                <option value = "3">Non-resident ES or EU</option>\n                            </select>\n                        </div>\n                    </fieldset>  \n                    <button type="button" class="bnb-button" id="calculate-button">Calculate Break Even</button>\n                </form>\n\n                <div id="result-table-container" style="display: none;">\n                    \n                    <table class="result-table" style = "display:none">\n                        <thead>\n                            <tr>\n                                <th >Interest Rate for Energy Certificate A and B</th>\n                                <th colspan="5">Mortgage Calculations</th>\n                            </tr>\n                            <tr>\n                                <td rowspan = "4" id = \'t_interestRate\'></td>\n                                <td>Total Monthly Payments</td>\n                                <td>Mortgage Amount</td>\n                                <td>Monthly Payment</td>\n                                <td>Total To Repay</td>\n                                <td>Interests</td>\n                            </tr>\n                            <tr>\n                                <td id = \'t_termYears\'></td>\n                                <td id = \'t_mortgageAmount\'></td>\n                                <td rowspan = "3" id = \'t_pmt\'></td>\n                                <td rowspan = "3" id = \'t_repay\'></td>\n                                <td rowspan = "3" id = \'t_interest\'></td>\n                            </tr>\n                            <tr>\n                                <td>Monthly Interest</td>\n                                <td>Monthly Principal</td>\n                            </tr>\n                            <tr>\n                                <td id = \'t_mInterest\'></td>\n                                <td id = \'t_mPrincipal\'></td>\n                            </tr>\n                        </thead>\n                    </table>\n\n                    <table class="result-table" id = "startupCostTable">\n                        <thead>\n                            <tr>\n                                <th colspan="2" style = "font-size:25px">Star-Up Costs</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            <tr>\n                                <td>Notary Costs</td>\n                                <td></td>\n                            </tr>\n                            <tr>\n                                <td>Tax Consultancy Costs</td>\n                                <td></td>\n                            </tr>\n                            <tr>\n                                <td>Registry Costs</td>\n                                <td></td>\n                            </tr>\n                            <tr>\n                                <td>Purchase Taxes</td>\n                                <td></td>\n                            </tr>\n                            <tr>\n                                <td>Registry Verification Costs</td>\n                                <td></td>\n                            </tr>\n                            <tr>\n                                <td>Valuation Costs</td>\n                                <td></td>\n                            </tr>\n                            <tr>\n                                <td>Deposit</td>\n                                <td></td>\n                            </tr>\n                            <tr>\n                                <td>Renovation & Furniture</td>\n                                <td></td>\n                            </tr>\n                            <tr class="total">\n                                <td>Total Star-Up Costs</td>\n                                <td></td>\n                            </tr>\n                        </tbody>\n                    </table>    \n\n                    <div id="startupCostChart" class="chart-container"></div>\n\n                    <table class="result-table" id = "mortgageTable">\n                        <thead>\n                            <tr>\n                                <th colspan="2" style = "font-size:25px">Mortgage Details</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            <tr>\n                                <th colspan="2">Mortgage Interest</th>\n                            </tr>\n                            <tr>\n                                <th>Monthly</th>\n                                <th>Annual</th>\n                            </tr>\n                            <tr>\n                                <td id="t_mIMonthly"></td>\n                                <td id="t_mIAnnual"></td>\n                            </tr>\n                            <tr>\n                                <th colspan="2">Mortgage Principal</th>\n                            </tr>\n                            <tr>\n                                <th>Monthly</th>\n                                <th>Annual</th>\n                            </tr>\n                            <tr>\n                                <td id="t_mPMonthly"></td>\n                                <td id="t_mPAnnual"></td>\n                            </tr>\n                            <tr>\n                                <th colspan="2">Total Mortgage Payment</th>\n                            </tr>\n                            <tr>\n                                <th>Monthly</th>\n                                <th>Annual</th>\n                            </tr> \n                            <tr>\n                                <td id="t_mTMonthly"></td>\n                                <td id="t_mTAnnual"></td>\n                            </tr>\n                            <tr>\n                                <th>Total Mortgage</th>\n                                <th id="t_mTotal"></th>\n                            </tr> \n                        </tbody>\n                    </table>\n\n                    <table class="result-table" id = "rentalTable">\n                        <thead>\n                            <tr>\n                                <th colspan="2" style = "font-size:25px">Rental Brut Income</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            <tr>\n                                <th>Monthly</th>\n                                <th>Annual</th>\n                            </tr>\n                            <tr>\n                                <td id="t_rentalMonthly"></td>\n                                <td id="t_rentalAnnual"></td>\n                            </tr>\n                        </tbody>\n                    </table>\n\n                    <table class="result-table" id = "rentingTable">\n                        <thead>\n                            <tr>\n                                <th colspan="2" style = "font-size:25px">Renting Platforms Fees</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            <tr>\n                                <th colspan="2">AirBnB Fees Total</th>\n                            </tr>\n                            <tr>\n                                <th>Monthly</th>\n                                <th>Annual</th>\n                            </tr>\n                            <tr>\n                                <td id="t_airBnBMonthly"></td>\n                                <td id="t_airBnBAnnual"></td>\n                            </tr>\n                            <tr>\n                                <th colspan="2">Booking.com Fees Total</th>\n                            </tr>\n                            <tr>\n                                <th>Monthly</th>\n                                <th>Annual</th>\n                            </tr>\n                            <tr>\n                                <td id="t_bookingMonthly"></td>\n                                <td id="t_bookingAnnual"></td>\n                            </tr>\n                            <tr>\n                                <th colspan="2">Total Renting Platform(s) Fees</th>\n                            </tr>\n                            <tr>\n                                <th id="t_rentingMonthly"></th>\n                                <th id="t_rentingAnnual"></th>\n                            </tr>\n                        </tbody>\n                    </table>\n\n                    <div id="rentingChart" class="chart-container"></div>\n\n                    <table class="result-table" id = "operationalTable">\n                        <thead>\n                            <tr>\n                                <th colspan="3" style = "font-size:25px">Operational Costs</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            <tr>\n                                <th></th>\n                                <th>Monthly</th>\n                                <th>Annual</th>\n                            </tr>\n                            <tr>\n                                <td>Management Fee</td>\n                                <td></td>\n                                <td></td>\n                            </tr>\n                            <tr>\n                                <td>Comunal Fees</td>\n                                <td></td>\n                                <td></td>\n                            </tr>\n                            <tr>\n                                <td>Maintenance</td>\n                                <td></td>\n                                <td></td>\n                            </tr>\n                            <tr>\n                                <td>Insurance</td>\n                                <td></td>\n                                <td></td>\n                            </tr>\n                            <tr>\n                                <td>License Obtaining and Renweal Fees</td>\n                                <td></td>\n                                <td></td>\n                            </tr>\n                            <tr>\n                                <td>Advertising Costs</td>\n                                <td></td>\n                                <td></td>\n                            </tr>\n                            <tr>\n                                <td>Gas Bills</td>\n                                <td></td>\n                                <td></td>\n                            </tr>\n                            <tr>\n                                <td>Energy Bills</td>\n                                <td></td>\n                                <td></td>\n                            </tr>\n                            <tr>\n                                <td>WiFi Costs</td>\n                                <td></td>\n                                <td></td>\n                            </tr>\n                            <tr>\n                                <td>Water Bills</td>\n                                <td></td>\n                                <td></td>\n                            </tr>\n                            <tr>\n                                <td>AirBnB Fees Total</td>\n                                <td></td>\n                                <td></td>\n                            </tr>\n                            <tr>\n                                <td>Booking.com Fees Total</td>\n                                <td></td>\n                                <td></td>\n                            </tr>\n                            <tr>\n                                <th>Total</th>\n                                <th></th>\n                                <th></th>\n                            </tr>\n                        </tbody>\n                    </table>\n\n                    <div id="operationalChart" class="chart-container"></div>\n\n                    <table class="result-table" id = "taxesTable">\n                        <thead>\n                            <tr>\n                                <th colspan="3" style = "font-size:25px">Taxes</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            <tr>\n                                <th></th>\n                                <th>Monthly</th>\n                                <th>Annual</th>\n                            </tr>\n                            <tr>\n                                <td>Property Tax Fee</td>\n                                <td></td>\n                                <td></td>\n                            </tr>\n                            <tr>\n                                <td>Rental Income Tax</td>\n                                <td></td>\n                                <td></td>\n                            </tr>\n                            <tr>\n                                <th>Total Taxes</th>\n                                <th></th>\n                                <th></th>\n                            </tr>\n                        </tbody>\n                    </table>\n\n                    <table class="result-table" id = "netIncomeTable">\n                        <thead>\n                            <tr>\n                                <th colspan="2" style = "font-size:25px">Net Income</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            <tr>\n                                <th>Monthly</th>\n                                <th>Annual</th>\n                            </tr>\n                            <tr>\n                                <td></td>\n                                <td></td>\n                            </tr>\n                            <tr>\n                                <th colspan="2">Break-even ROI in Years</th>\n                            </tr>\n                            <tr>\n                                <th colspan="2">7.6 Years</th>\n                            </tr>\n                            <tr>\n                                <th colspan="2">13.1% Annual ROI</th>\n                            </tr>\n                        </tbody>\n                    </table>\n\n                    <div id="netIncomeChart" class="chart-container"></div>\n                    \n                    <form>\n                        <button type="button" class="bnb-button" id="pdf-button">PDF Download</button>\n                    </form>\n                    <table class="result-table" id = "paymentPlanTable" style="display:none">\n                        <thead>\n                            <tr>\n                                <th colspan="5" style = "font-size:25px">Mortgage Repayment Plan</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            <tr>\n                                <th>Period</th>\n                                <th>Beginning Balance</th>\n                                <th>Monthly Payment</th>\n                                <th>Interest Payment</th>\n                                <th>Principal Payment</th>\n                            </tr>\n                        </tbody>\n                    </table>\n\n                </div>\n\n            </div>\n        </div>\n    ',document.getElementById("calculate-button").addEventListener("click",(function(){const t=document.getElementById("termYears").value,n=document.getElementById("propertyType").checked,e=document.getElementById("purchasePrice").value,a=document.getElementById("propertyPrice").value;let o=document.getElementById("interestRate").value;o=n?o-.1:o;const l=o/12/100,r=e-a,s=l*r/(1-Math.pow(1+l,12*-t)),c=s-l*r;document.getElementById("t_interestRate").innerHTML=d(o)+"%",document.getElementById("t_termYears").innerHTML=d(12*t),document.getElementById("t_mortgageAmount").innerHTML=`&#8364; ${d(r)}`,document.getElementById("t_mInterest").innerHTML=`&#8364; ${d(l*r)}`,document.getElementById("t_mPrincipal").innerHTML=`&#8364; ${d(c)}`,document.getElementById("t_pmt").innerHTML=`&#8364; ${d(s)}`,document.getElementById("t_repay").innerHTML=`&#8364; ${d(s*t*12)}`,document.getElementById("t_interest").innerHTML=`&#8364; ${d(s*t*12-r)}`;const m=document.getElementById("startupCostTable"),p=m.getElementsByTagName("tr"),g=document.getElementById("propertyTypeCmb").value,u=parseFloat(document.getElementById("startupFeeFurnishing").value),y=parseFloat(document.getElementById("startupFeeRenovations").value);let h=0;m.getElementsByTagName("td")[1].innerHTML=`&#8364; ${d(.005*e)}`,m.getElementsByTagName("td")[3].innerHTML=`&#8364; ${d(.003*e)}`,m.getElementsByTagName("td")[5].innerHTML=`&#8364; ${d(.002*e)}`,m.getElementsByTagName("td")[7].innerHTML=`&#8364; ${d(e*g/100)}`,m.getElementsByTagName("td")[9].innerHTML=`&#8364; ${d(50)}`,m.getElementsByTagName("td")[11].innerHTML=`&#8364; ${d(.002*e)}`,m.getElementsByTagName("td")[13].innerHTML=`&#8364; ${d(a)}`,m.getElementsByTagName("td")[15].innerHTML=`&#8364; ${d(u+y)}`;for(let t=1;t<p.length-1;t++){let n=p[t].getElementsByTagName("td")[1].textContent.replace(/[^\d.,-]/g,"").replaceAll(",","");h+=parseFloat(n)}m.getElementsByTagName("td")[17].innerHTML=`&#8364;${d(h)}`,i("startupCostChart","Breakdown of start-up costs",[{name:"Notary Costs",y:.005*e,color:"#3498db"},{name:"Tax Consultancy Costs",y:.003*e,color:"#e74c3c"},{name:"Registry Costs",y:.002*e,color:"#f1c40f"},{name:"Purchase Taxes",y:e*g/100,color:"#2ecc71"},{name:"Registry Verification Costs",y:50,color:"#f39c12"},{name:"Valuation Costs",y:.002*e,color:"#16a085"},{name:"Deposit",y:1*a,color:"#95a5a6"},{name:"Renovation & Furniture",y:u+y,color:"#e67e22"}]),document.getElementById("t_mIMonthly").innerHTML=`&#8364; ${d(l*r)}`,document.getElementById("t_mIAnnual").innerHTML=`&#8364; ${d(l*r*12)}`,document.getElementById("t_mPMonthly").innerHTML=`&#8364 ;${d(c)}`,document.getElementById("t_mPAnnual").innerHTML=`&#8364; ${d(12*c)}`,document.getElementById("t_mTMonthly").innerHTML=`&#8364 ;${d(s)}`,document.getElementById("t_mTAnnual").innerHTML=`&#8364; ${d(12*s)}`,document.getElementById("t_mTotal").innerHTML=`&#8364; ${d(s*t*12)}`;const b=document.getElementById("rentalPrice").value,f=document.getElementById("rentalMax").value,T=document.getElementById("rentalRate").value,B=document.getElementById("rentalAnnual").value,E=b*f*T*B/1200,v=b*f*T*B/100;document.getElementById("t_rentalMonthly").innerHTML=`&#8364; ${d(E)}`,document.getElementById("t_rentalAnnual").innerHTML=`&#8364; ${d(v)}`;const M=document.getElementById("isAirBnB").checked,x=document.getElementById("isBooking").checked,I=document.getElementById("rentingAirBnB").value,L=document.getElementById("rentingBooking").value;let H=0,$=0,C=0;M&&!x?(H=I*E/100,$=0,C=H):!M&&x?(H=0,$=L*E/100,C=$):M&&x&&(H=I*E/200,$=L*E/200,C=H+$),document.getElementById("t_airBnBMonthly").innerHTML=`&#8364; ${d(H)}`,document.getElementById("t_airBnBAnnual").innerHTML=`&#8364; ${d(12*H)}`,document.getElementById("t_bookingMonthly").innerHTML=`&#8364; ${d($)}`,document.getElementById("t_bookingAnnual").innerHTML=`&#8364; ${d(12*$)}`,document.getElementById("t_rentingMonthly").innerHTML=`&#8364; ${d(C)}`,document.getElementById("t_rentingAnnual").innerHTML=`&#8364; ${d(12*C)}`,i("rentingChart","Renting Platform Fees",[{name:"AirBnB",y:12*H,color:"#3498db"},{name:"Booking.com",y:12*$,color:"#e74c3c"}]);const F=document.getElementById("operationalTable"),N=F.getElementsByTagName("tr"),A=document.getElementById("managementFee").value,P=document.getElementById("communityFee").value,w=document.getElementById("maintenanceFee").value,_=document.getElementById("insuranceFee").value,k=document.getElementById("licenseFee").value,R=document.getElementById("advertisingFee").value,S=document.getElementById("gasFee").value,z=document.getElementById("energyFee").value,O=document.getElementById("wifiFee").value,j=document.getElementById("waterFee").value;let Y=0,D=0,U=0;F.getElementsByTagName("td")[1].innerHTML=`&#8364; ${d(A*E/100)}`,F.getElementsByTagName("td")[2].innerHTML=`&#8364; ${d(A*v/100)}`,F.getElementsByTagName("td")[4].innerHTML=`&#8364; ${d(P/12)}`,F.getElementsByTagName("td")[5].innerHTML=`&#8364; ${d(P)}`,F.getElementsByTagName("td")[7].innerHTML=`&#8364; ${d(w/12)}`,F.getElementsByTagName("td")[8].innerHTML=`&#8364; ${d(w)}`,F.getElementsByTagName("td")[10].innerHTML=`&#8364; ${d(_/12)}`,F.getElementsByTagName("td")[11].innerHTML=`&#8364; ${d(_)}`,F.getElementsByTagName("td")[13].innerHTML=`&#8364; ${d(k/12)}`,F.getElementsByTagName("td")[14].innerHTML=`&#8364; ${d(k)}`,F.getElementsByTagName("td")[16].innerHTML=`&#8364; ${d(R/12)}`,F.getElementsByTagName("td")[17].innerHTML=`&#8364; ${d(R)}`,F.getElementsByTagName("td")[19].innerHTML=`&#8364; ${d(S)}`,F.getElementsByTagName("td")[20].innerHTML=`&#8364; ${d(12*S)}`,F.getElementsByTagName("td")[22].innerHTML=`&#8364; ${d(z)}`,F.getElementsByTagName("td")[23].innerHTML=`&#8364; ${d(12*z)}`,F.getElementsByTagName("td")[25].innerHTML=`&#8364; ${d(O)}`,F.getElementsByTagName("td")[26].innerHTML=`&#8364; ${d(12*O)}`,F.getElementsByTagName("td")[28].innerHTML=`&#8364; ${d(j)}`,F.getElementsByTagName("td")[29].innerHTML=`&#8364; ${d(12*j)}`,F.getElementsByTagName("td")[31].innerHTML=`&#8364; ${d(H)}`,F.getElementsByTagName("td")[32].innerHTML=`&#8364; ${d(12*H)}`,F.getElementsByTagName("td")[34].innerHTML=`&#8364; ${d($)}`,F.getElementsByTagName("td")[35].innerHTML=`&#8364; ${d(12*$)}`;for(let t=2;t<N.length-1;t++){let n=N[t].getElementsByTagName("td")[1],e=N[t].getElementsByTagName("td")[2],a=n.textContent.replace(/[^\d.,-]/g,"").replaceAll(",",""),o=e.textContent.replace(/[^\d.,-]/g,"").replaceAll(",","");Y+=parseFloat(a),D+=parseFloat(o),t<N.length-3&&(U+=parseFloat(o))}F.getElementsByTagName("th")[5].innerHTML=`&#8364;${d(Y)}`,F.getElementsByTagName("th")[6].innerHTML=`&#8364;${d(D)}`,i("operationalChart","Monthly Operational Costs",[{name:"Management Fee",y:A*E/100,color:"#3498db"},{name:"Comunal Fees",y:P/12,color:"#e74c3c"},{name:"Maintenance",y:w/12,color:"#f1c40f"},{name:"Insurance",y:_/12,color:"#2ecc71"},{name:"License Obtaining and Renweal Fees",y:k/12,color:"#f39c12"},{name:"Advertising Costs",y:R/12,color:"#16a085"},{name:"Gas Bills",y:S,color:"#95a5a6"},{name:"Energy Bills",y:z,color:"#e67e22"},{name:"WiFi Costs",y:O,color:"#f68e22"},{name:"Water Bills",y:j,color:"#d36e22"},{name:"AirBnB Fees Total",y:H,color:"#d36c69"},{name:"Booking.com Fees Total",y:$,color:"#3654db"}]);const W=document.getElementById("taxesTable"),G=document.getElementById("propertyTax").value,V=n?e*G*.008:e*G/100,q=document.getElementById("livingTypeCmb").value,X=v-U-.03*e-l*r*12-12*C;let J=0,K=0,Q=0,Z=0;"1"==q?K=.19*X:"2"==q?(J=X<=12450?.19:X<=20200?.24:X<=35200?.3:X<=6e4?.37:X<=3e5?.45:.47,K=X*J):"3"==q&&(K=.24*v),Q=V/12+K/12,Z=V+K,console.log("totalTaxesMonthly",Q),W.getElementsByTagName("td")[1].innerHTML=`&#8364; ${d(V/12)}`,W.getElementsByTagName("td")[2].innerHTML=`&#8364; ${d(V)}`,W.getElementsByTagName("td")[4].innerHTML=`&#8364; ${d(K/12)}`,W.getElementsByTagName("td")[5].innerHTML=`&#8364; ${d(K)}`,W.getElementsByTagName("th")[5].innerHTML=`&#8364; ${d(Q)}`,W.getElementsByTagName("th")[6].innerHTML=`&#8364; ${d(Z)}`;const tt=document.getElementById("netIncomeTable"),nt=v-12*s-D-Z,et=s*t*12+h;tt.getElementsByTagName("td")[0].innerHTML=`&#8364; ${d(nt/12)}`,tt.getElementsByTagName("td")[1].innerHTML=`&#8364; ${d(nt)}`,tt.getElementsByTagName("th")[4].innerHTML=`${d(et/nt,1)} Years`,tt.getElementsByTagName("th")[5].innerHTML=`${d(nt/et*100,1)}% Annual ROI`,i("netIncomeChart","",[{name:"Net Income",y:nt,color:"#3498db"},{name:"Taxes",y:Z,color:"#e74c3c"},{name:"Operational Costs",y:D,color:"#f1c40f"},{name:"Mortgage Payment",y:12*s,color:"#2ecc71"}]);const at=document.getElementById("paymentPlanTable");let ot=r,lt=s;if(0!=ot&&0!=lt){let t=ot*o/1200,n=lt-t;for(let e=1;e<361;e++){const a=document.createElement("tr"),l=document.createElement("td");l.textContent=e;const r=document.createElement("td");r.textContent=`€ ${d(ot)}`;const i=document.createElement("td");i.textContent=`€ ${d(lt)}`;const s=document.createElement("td");s.textContent=`€ ${d(t)}`;const c=document.createElement("td");c.textContent=`€ ${d(n)}`,a.appendChild(l),a.appendChild(r),a.appendChild(i),a.appendChild(s),a.appendChild(c),at.appendChild(a),ot-=n,t=ot*o/1200,n=lt-t}}document.getElementById("result-table-container").style.display="block"}));const o=document.querySelectorAll(".info-icon"),l=document.getElementById("tooltip"),r=["Select the mortgage duration (10, 15, 20, 25, or 30 years).","Enter the agreed purchase price of the property.","Input the annual interest rate offered by the lender (Bank).","Enter the initial deposit amount (banks generally require at least 10% of the property’s value).","Select if the property has an Energy Performance Certificate (EPC) rating of A or B, eligible for a 0.1% loan rate reduction and 20% tax reduction.","Choose whether the property is new (subject to 11.5% tax) or resale (subject to 8% tax).","Enter the cost of furnishing the home.","Enter the estimated or actual cost of property renovations.","Enter the nightly rate charged per guest.","Enter the maximum number of guests allowed per booking.","Enter the average percentage of booked nights throughout the year.","Enter the total number of days the property is available for bookings each year.","Enter the percentage charged for property management services, typically between 10% and 30% of rental revenue.","Enter the annual amount of property tax, calculated as a percentage of the value of the property. 1.1% is usually the highest rate in Spain.","Enter the annual fee for shared property services, typically between €50 Euro and €200 in Spain.","Enter the estimated annual cost for property upkeep and repairs.","Enter the annual cost of insurance coverage for the property.","Enter the annual cost for license acquisition and renewal, generally around €500.","Enter the monthly budget for advertising and marketing the property.","Enter the average monthly cost of gas.","Enter the average monthly electricity expense.","Enter the monthly cost for internet services.","Enter the average monthly water bill.","Yes if listing on Airbnb, applying a 3% fee, or No if not.","Yes if listing on Booking.com, applying a 10% fee, or No if not.","Spanish Residents: Subject to progressive tax rates on rental income, eligible expenses recognized by Agencia Tributaria (Spanish Tax Agency):19% for income up to €12,45024% for income from €12,451 to €20,20030% for income from €20,201 to €35,20037% for income from €35,201 to €60,00045% for income from €60,001 to €300,000 47% for income over €300,000  EU citizens are subject to a 19% flat rate with eligible expenses recognized by Agencia Tributaria (Spanish Tax Agency). Non-EU/ES residents pay a 24% flat rate with no expenses recognized."];function i(t,n,e){Highcharts.chart(t,{credits:{enabled:!1},chart:{type:"pie",backgroundColor:"#f3f4f6",options3d:{enabled:!0,alpha:45,beta:0}},title:{text:n,style:{fontSize:"20px"}},legend:{enabled:!0,layout:"vertical",align:"right",verticalAlign:"middle",width:120,itemStyle:{fontSize:"14px"},itemMarginTop:5,itemMarginBottom:5,floating:!1},plotOptions:{pie:{innerSize:0,depth:45,dataLabels:{enabled:!0,format:"{point.name}<br>€{point.y:.2f}",style:{fontSize:"14px"}}}},series:[{name:"Cost",data:e}],tooltip:{pointFormat:"{series.name}: <b>€{point.y:.2f}</b>"}})}function d(t,n){return(null==t||isNaN(t))&&(t=0),(null==n||isNaN(n))&&(n=2),new Intl.NumberFormat("en-US",{minimumFractionDigits:n,maximumFractionDigits:n}).format(t)}o.forEach((t=>{t.addEventListener("mouseenter",(function(n){const e=t.getAttribute("data-tooltip");l.textContent=r[e],l.style.display="block",l.style.left=n.pageX+"px",l.style.top=n.pageY+20+"px"})),t.addEventListener("mouseleave",(function(){l.style.display="none"}))})),document.getElementById("pdf-button").addEventListener("click",(function(){!function(){paymentPlanTable=document.getElementById("paymentPlanTable");const t=document.getElementById("result-table-container");document.getElementById("pdf-button").style.display="none",paymentPlanTable.style.display="revert",html2pdf().from(t).set({margin:1,filename:"my-document.pdf",html2canvas:{scale:2},jsPDF:{format:"a4",orientation:"portrait"}}).save().then((()=>{document.getElementById("pdf-button").style.display="block",paymentPlanTable.style.display="none"}))}()}))}));